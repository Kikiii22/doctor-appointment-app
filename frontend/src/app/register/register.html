<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<div class="d-flex align-items-center justify-content-center min-vh-100 bg-gradient position-relative overflow-hidden py-4" style="background: linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%);">
  <div class="position-absolute top-0 start-0 w-100 h-100" style="background-image: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Cdefs%3E%3Cpattern id=%22grid%22 width=%2210%22 height=%2210%22 patternUnits=%22userSpaceOnUse%22%3E%3Cpath d=%22M 10 0 L 0 0 0 10%22 fill=%22none%22 stroke=%22%23e2e8f0%22 stroke-width=%220.5%22/%3E%3C/pattern%3E%3C/defs%3E%3Crect width=%22100%22 height=%22100%22 fill=%22url(%23grid)%22/%3E%3C/svg%3E'); opacity: 0.3;">
  </div>

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">
        <div class="card border-0 shadow-lg rounded-4 overflow-hidden">

          <div class="card-header bg-primary text-white text-center py-4 position-relative" style="background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%) !important;">
            <div class="position-relative">
              <i class="fas fa-user-plus fs-1 mb-2 text-white-50"></i>
              <h2 class="h3 fw-bold mb-0 text-white">Register to Najdi si Doktorce</h2>
              <p class="small mb-0 text-white-50">Create Your Account</p>
            </div>
          </div>

          <div class="card-body p-4 p-md-5">
            <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">

              <!-- Username Field -->
              <div class="mb-4">
                <label for="username" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-user me-2 text-primary"></i>Username
                </label>
                <div class="position-relative">
                  <input
                    type="text"
                    id="username"
                    formControlName="username"
                    class="form-control form-control-lg border-2 rounded-3 ps-4 pe-3"
                    [class.is-invalid]="registerForm.get('username')?.invalid && registerForm.get('username')?.touched"
                    placeholder="Enter your username (max 50 chars)"
                    style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <div class="invalid-feedback" *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Username is required (max 50 chars)
                  </div>
                </div>
              </div>

              <!-- Password Field -->
              <div class="mb-4">
                <label for="password" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-lock me-2 text-primary"></i>Password
                </label>
                <div class="position-relative">
                  <input
                    [type]="showPassword ? 'text' : 'password'"
                    id="password"
                    formControlName="password"
                    class="form-control form-control-lg border-2 rounded-3 ps-4 pe-3"
                    [class.is-invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
                    placeholder="Enter your password (min 6 chars)"
                    style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <button
                    type="button"
                    class="btn btn-link position-absolute top-50 end-0 translate-middle-y me-2 p-0 text-muted"
                    (click)="showPassword = !showPassword"
                    style="z-index: 10;">
                    <i [class]="showPassword ? 'fas fa-eye' : 'fas fa-eye-slash'"></i>
                  </button>

                  <div class="invalid-feedback" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Password is required (min 6 chars)
                  </div>

                </div>
              </div>

              <!-- Email Field -->
              <div class="mb-4">
                <label for="email" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-envelope me-2 text-primary"></i>Email
                </label>
                <div class="position-relative">
                  <input
                    type="email"
                    id="email"
                    formControlName="email"
                    class="form-control form-control-lg border-2 rounded-3 ps-4 pe-3"
                    [class.is-invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched"
                    placeholder="Enter your email address"
                    style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <div class="invalid-feedback" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Please enter a valid email address
                  </div>
                </div>
              </div>

              <!-- Full Name Field -->
              <div class="mb-4">
                <label for="fullName" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-id-card me-2 text-primary"></i>Full Name
                </label>
                <div class="position-relative">
                  <input
                    type="text"
                    id="fullName"
                    formControlName="fullName"
                    class="form-control form-control-lg border-2 rounded-3 ps-4 pe-3"
                    [class.is-invalid]="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched"
                    placeholder="Enter your full name"
                    style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <div class="invalid-feedback" *ngIf="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Full Name is required
                  </div>
                </div>
              </div>

              <!-- Phone Field -->
              <div class="mb-4">
                <label for="phone" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-phone me-2 text-primary"></i>Phone
                </label>
                <div class="position-relative">
                  <input
                    type="tel"
                    id="phone"
                    formControlName="phone"
                    class="form-control form-control-lg border-2 rounded-3 ps-4 pe-3"
                    [class.is-invalid]="registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched"
                    placeholder="Enter your phone number"
                    style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <div class="invalid-feedback" *ngIf="registerForm.get('phone')?.invalid && registerForm.get('phone')?.touched">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Phone is required
                  </div>
                </div>
              </div>

              <!-- Role Field -->
              <div class="mb-4">
                <label for="role" class="form-label fw-medium text-dark mb-2">
                  <i class="fas fa-user-tag me-2 text-primary"></i>Role
                </label>
                <select
                  id="role"
                  formControlName="role"
                  (change)="onRoleChange()"
                  class="form-select form-select-lg border-2 rounded-3 ps-4"
                  style="border-color: #e2e8f0; transition: all 0.3s ease;">
                  <option *ngFor="let r of roles" [ngValue]="r">{{ r }}</option>
                </select>
              </div>

              <!-- Doctor-specific Fields -->
              <ng-container *ngIf="isDoctor()">
                <div class="doctor-fields">
                  <!-- Hospital Field -->
                  <div class="mb-4">
                    <label for="hospitalId" class="form-label fw-medium text-dark mb-2">
                      <i class="fas fa-hospital me-2 text-primary"></i>Hospital
                    </label>
                    <select
                      id="hospitalId"
                      formControlName="hospitalId"
                      (change)="onHospitalChange()"
                      class="form-select form-select-lg border-2 rounded-3 ps-4"
                      style="border-color: #e2e8f0; transition: all 0.3s ease;">
                      <option [ngValue]="null">Select hospital</option>
                      <option *ngFor="let h of hospitals" [ngValue]="h.id">{{ h.name }}</option>
                    </select>
                  </div>

                  <!-- Department.ts Field -->
                  <div class="mb-4">
                    <label for="departmentId" class="form-label fw-medium text-dark mb-2">
                      <i class="fas fa-stethoscope me-2 text-primary"></i>Department
                    </label>
                    <select
                      id="departmentId"
                      formControlName="departmentId"
                      class="form-select form-select-lg border-2 rounded-3 ps-4"
                      style="border-color: #e2e8f0; transition: all 0.3s ease;">
                      <option [ngValue]="null">Select department</option>
                      <option *ngFor="let d of departments" [ngValue]="d.id">{{ d.name }}</option>
                    </select>
                  </div>
                </div>
              </ng-container>

              <!-- Submit Button -->
              <button
                type="submit"
                [disabled]="registerForm.invalid || loading"
                class="btn btn-primary btn-lg w-100 rounded-3 fw-semibold position-relative register-btn py-3"
                style="background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%); border: none; transition: all 0.3s ease; min-height: 56px;">

                <span *ngIf="!loading" class="d-flex align-items-center justify-content-center">
                  <i class="fas fa-user-plus me-2"></i>
                  Register
                </span>

                <span *ngIf="loading" class="d-flex align-items-center justify-content-center">
                  <div class="spinner-border spinner-border-sm me-2" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  Creating account...
                </span>
              </button>

            </form>

            <!-- Login Link -->
            <div class="text-center mt-4 pt-3 border-top border-light">
              <p class="text-muted mb-0">
                Already have an account?
                <a [routerLink]="['/login']" class="text-primary text-decoration-none fw-medium position-relative login-link">
                  Login here
                  <span class="position-absolute bottom-0 start-0 w-100 bg-primary" style="height: 2px; transform: scaleX(0); transition: transform 0.3s ease; transform-origin: right;"></span>
                </a>
              </p>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
